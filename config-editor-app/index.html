<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coding Agent Notifications</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>Coding agent notifications</h1>
            <button class="btn-save" id="saveBtn" disabled style="display: none;" title="Save your settings. Changes take effect immediately for new Claude sessions.">Save</button>
        </header>

        <div class="layout">
            <!-- Left Navigation -->
            <nav class="sidebar">
                <div class="nav-item active" data-view="overview">Overview</div>
                <div class="nav-item" data-view="claude-code">Claude Code</div>
                <div class="nav-item" data-view="custom-sounds">Audio library</div>
                <div class="nav-item" data-view="faq">FAQ</div>
                <div class="nav-item" data-view="recent-activity">Activity</div>
                <div class="nav-item" data-view="support">Support</div>
            </nav>

            <!-- Main Content Area -->
            <main class="main">
                <!-- Overview View -->
                <div class="view active" data-view="overview">
                    <!-- Getting started section (shown when installed) -->
                    <div id="installedContent" class="getting-started">
                        <h2>Getting started</h2>
                        <p class="getting-started-text">
  Installation was successful, consequently notifications have been enabled for all future Claude Code sessions. Sessions that were started before this application was run for the first time will need to be restarted.
   
                            <br><br>If you have any questions, encounter any issues, or would like to request a feature or improvement, please <a href="mailto:cwveysey@gmail.com" class="inline-link">drop me a line via email</a>. Any and all feedback is of course so appreciated.
                        </p>

                        <h2 style="margin-top: 24px;">Next steps</h2>
                        <ul class="getting-started-text">
                            <li>You will receive notifications for designated coding agent events.</li>
                            <li>Review <a href="#" class="inline-link" onclick="event.preventDefault(); document.querySelector('[data-view=claude-code]').click(); requestAnimationFrame(() => { const details = document.getElementById('customization-details'); if (details) { details.open = true; details.scrollIntoView({block: 'start'}); } });">your customization options</a> (e.g. turn alerts on and off per event type, arrange for different audio to play per event type).</li>
                            <li>Read <a href="#" class="inline-link" onclick="event.preventDefault(); document.querySelector('[data-view=faq]').click();">the FAQs</a> for answers to frequently asked questions.</li>
                        </ul>
                    </div>

                    <!-- Uninstalled content (shown when uninstalled) -->
                    <div id="uninstalledContent" class="getting-started" style="display: none;">
                        <h2>Required values were removed</h2>
                        <p class="getting-started-text">
                            If you are reading this copy, that means that values required for this application's notifications are missing from <code>~/.claude/scripts/</code> and <code>~/.claude/settings.json</code>.

                            <br><br>If you would like for these values to be restored then please click the button below.
                        </p>
                        <button id="reinstallBannerBtn" class="btn-secondary" style="margin-top: 24px;">Restore notifications values</button>
                    </div>

                    <!-- Privacy section (always shown) -->
                    <div class="getting-started">
                        <h2 style="margin-top: 24px;">Privacy</h2>
                        <div class="card">
                            <div class="setting-row">
                                <div class="setting-label">
                                    <label for="analyticsEnabled">Help improve this app by sharing anonymous usage data</label>
                                    <p class="hint">Anonymous usage data helps us improve the app. Personal data, file paths, and project names are never collected. <a href="#" class="inline-link" onclick="event.preventDefault(); document.querySelector('[data-view=faq]').click(); requestAnimationFrame(() => { const faq = document.getElementById('privacy-faq'); if (faq) { faq.open = true; faq.scrollIntoView({block: 'start'}); } });">Learn more.</a></p>
                                </div>
                                <div class="sound-control">
                                    <input type="checkbox" id="analyticsEnabled" class="toggle" checked>
                                </div>
                            </div>
                        </div>
                        <!-- Install Section (Auto-installs on first launch) -->
                        <div id="installSection" style="display: none; margin: 48px 0; padding: 48px 0; border-top: 1px solid rgba(0, 0, 0, 0.08); border-bottom: 1px solid rgba(0, 0, 0, 0.08);">
                            <div style="max-width: 560px; margin: 0 auto; text-align: center;">
                                <div style="margin-bottom: 24px;">
                                    <svg style="width: 48px; height: 48px; animation: spin 1s linear infinite;" viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10" stroke="#1a73e8" stroke-width="2" fill="none" stroke-dasharray="60" stroke-dashoffset="20" stroke-linecap="round"/>
                                    </svg>
                                    <style>
                                        @keyframes spin {
                                            0% { transform: rotate(0deg); }
                                            100% { transform: rotate(360deg); }
                                        }
                                    </style>
                                </div>
                                <h3 style="font-size: 20px; margin: 0 0 16px 0; color: #202124; font-weight: 500;">Completing notification setup...</h3>
                                <p style="font-size: 15px; line-height: 1.7; color: #5f6368; margin-bottom: 32px; font-weight: 400;">
                                    Setting up your notification system. This will only take a moment.
                                </p>
                                <ul style="text-align: left; list-style: none; padding: 0; margin: 0; color: #5f6368; font-size: 14px; line-height: 2;">
                                    <li style="padding-left: 24px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #1a73e8;">→</span>
                                        Installing scripts to <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 3px; font-size: 13px;">~/.claude/scripts/</code>
                                    </li>
                                    <li style="padding-left: 24px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #1a73e8;">→</span>
                                        Configuring Claude Code hooks
                                    </li>
                                    <li style="padding-left: 24px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #1a73e8;">→</span>
                                        Enabling notifications
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Claude Code View -->
                <div class="view" data-view="claude-code" style="display: none;">
                    <div class="card">
                        <!-- Column headers -->
                        <div class="table-header">
                            <div class="table-header-cell">Event</div>
                            <div class="table-header-controls">
                                <div class="table-header-cell sound-header">Sound</div>
                                <div class="table-header-cell play-header"></div>
                                <div class="table-header-cell audio-header">Audio</div>
                                <div class="table-header-cell visual-header">Visual</div>
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="notificationSound">Notification</label>
                                <p class="hint">Runs when Claude Code sends notifications (<a href="https://docs.claude.com/en/docs/claude-code/hooks-guide#hook-events-overview" target="_blank" class="inline-link">documentation</a>)</p>
                            </div>
                            <div class="sound-control">
                                <select id="notificationSound" class="sound-select"></select>
                                <button class="btn-play" data-sound="notification" title="Preview this sound">▶</button>
                                <input type="checkbox" id="notificationAudio" class="toggle" checked title="Play audio notification">
                                <input type="checkbox" id="notificationVisual" class="toggle" checked title="Show visual notification">
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="stopSound">Stop</label>
                                <p class="hint">Runs when Claude Code finishes responding (<a href="https://docs.claude.com/en/docs/claude-code/hooks-guide#hook-events-overview" target="_blank" class="inline-link">documentation</a>)</p>
                            </div>
                            <div class="sound-control">
                                <select id="stopSound" class="sound-select"></select>
                                <button class="btn-play" data-sound="stop" title="Preview this sound">▶</button>
                                <input type="checkbox" id="stopAudio" class="toggle" checked title="Play audio notification">
                                <input type="checkbox" id="stopVisual" class="toggle" checked title="Show visual notification">
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="preToolUseSound">PreToolUse</label>
                                <p class="hint">Runs before tool calls (permission prompts) (<a href="https://docs.claude.com/en/docs/claude-code/hooks-guide#hook-events-overview" target="_blank" class="inline-link">documentation</a>)</p>
                            </div>
                            <div class="sound-control">
                                <select id="preToolUseSound" class="sound-select"></select>
                                <button class="btn-play" data-sound="preToolUse" title="Preview this sound">▶</button>
                                <input type="checkbox" id="preToolUseAudio" class="toggle" checked title="Play audio notification">
                                <input type="checkbox" id="preToolUseVisual" class="toggle" checked title="Show visual notification">
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="postToolUseSound">PostToolUse</label>
                                <p class="hint">Runs after tool calls complete (<a href="https://docs.claude.com/en/docs/claude-code/hooks-guide#hook-events-overview" target="_blank" class="inline-link">documentation</a>)</p>
                            </div>
                            <div class="sound-control">
                                <select id="postToolUseSound" class="sound-select"></select>
                                <button class="btn-play" data-sound="postToolUse" title="Preview this sound">▶</button>
                                <input type="checkbox" id="postToolUseAudio" class="toggle" checked title="Play audio notification">
                                <input type="checkbox" id="postToolUseVisual" class="toggle" checked title="Show visual notification">
                            </div>
                        </div>

                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="subagentStopSound">SubagentStop</label>
                                <p class="hint">Runs when subagent tasks complete (<a href="https://docs.claude.com/en/docs/claude-code/hooks-guide#hook-events-overview" target="_blank" class="inline-link">documentation</a>)</p>
                            </div>
                            <div class="sound-control">
                                <select id="subagentStopSound" class="sound-select"></select>
                                <button class="btn-play" data-sound="subagentStop" title="Preview this sound">▶</button>
                                <input type="checkbox" id="subagentStopAudio" class="toggle" checked title="Play audio notification">
                                <input type="checkbox" id="subagentStopVisual" class="toggle" checked title="Show visual notification">
                            </div>
                        </div>
                    </div>

                    <!-- Focus Settings -->
                    <h2 id="focus-settings" class="hooks-header" style="margin-top: 32px;">Focus settings</h2>
                    <div class="card">
                        <div class="setting-row">
                            <div class="setting-label">
                                <label for="respectDND">Silence audio when a Focus is active</label>
                                    <p class="hint"> If this toggle is in the on position, then audio notifications will not play while any Focus is active. If this toggle is in the off position, then audio notifications will play regardless of whether or not a Focus is active.
                                    <br><br>
                                Do Not Disturb, Work, and Sleep are all examples of <a href="https://support.apple.com/guide/mac-help/change-focus-settings-mchlff5da36d/mac" target="_blank" class="inline-link">Apple "Focuses."</a>
                            </p>
                            </div>
                            <div class="sound-control">
                                <input type="checkbox" id="respectDND" class="toggle">
                            </div>
                        </div>
                    </div>

                    <div class="getting-started">
                        <details class="collapsible-section" id="customization-details">
                            <summary class="collapsible-header">
                                <h2>Some customization details</h2>
                            </summary>
                            <div class="collapsible-content">
                                <p class="getting-started-text">
                                    Using the controls above:
                                </p>
                                <ul class="getting-started-text">
                                    <li>Visual notifications can be turned on and off on a per event basis.</li>
                                    <li>Audio alerts can be turned on and off on a per event basis.</li>
                                    <li>You can arrange for different audio to play on a per event basis.</li>
                                    <li>You can arrange for custom audio to be used for alerts.</li>
                                    <li>You can choose how <a href="https://support.apple.com/guide/mac-help/change-focus-settings-mchlff5da36d/mac" target="_blank" class="inline-link">Apple "Focuses"</a> affect this application's audio alerts.</li>
                                </ul>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- Recent Activity View -->
                <div class="view" data-view="recent-activity" style="display: none;">
                    <div class="getting-started">
                        <h2>Activity log</h2>
                        <p class="getting-started-text">
                            This view shows details related to 50 of your most recent coding agent events.
                        </p>
                    </div>

                    <div class="card">
                        <div id="activityTableContainer">
                            <table class="activity-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Event</th>
                                        <th>Message</th>
                                    </tr>
                                </thead>
                                <tbody id="activityTableBody">
                                    <tr>
                                        <td colspan="3" class="empty-state-cell">
                                            <div class="empty-state">
                                                <p class="hint">No recent activity to display.</p>
                                                <p class="hint" style="margin-top: 8px;">Events will appear here as Claude Code triggers notifications.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Audio Library View -->
                <div class="view" data-view="custom-sounds" style="display: none;">
                    <div class="getting-started">
                        <h2>Audio library</h2>
                        <p class="getting-started-text">
                            By default Apple's native alert sounds, as well as some AI-generated audio from <a href="https://fish.audio/" target="_blank" class="inline-link">Fish Audio</a>, can be used for this application's audio notifications. You can also upload your own audio using the button below. <br><br>Supported formats: .aiff, .wav, .mp3
                        </p>
                    </div>

                    <div class="card">
                        <h2>Your audio files</h2>
                        <div id="customSounds" class="sound-library">
                            <!-- Custom sound items will be inserted here -->
                        </div>
                        <button class="btn-add" id="uploadSoundBtn">+ Upload audio</button>
                    </div>
                </div>

                <!-- FAQ View -->
                <div class="view" data-view="faq" style="display: none;">
                    <div class="getting-started">
                        <h2>Frequently Asked Questions</h2>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">What coding agents are supported by this tool?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <p class="faq-answer">At present exclusively Claude Code. I would be happy to add support for <a href="https://github.com/features/copilot" target="_blank" class="inline-link">Codex</a>, <a href="https://sourcegraph.com/amp" target="_blank" class="inline-link">Amp</a>, <a href="https://www.droids.dev" target="_blank" class="inline-link">Droids</a>, <a href="https://www.jules.ai" target="_blank" class="inline-link">Jules</a>, and other coding agents if there is demand for that. <a href="mailto:cwveysey@gmail.com" class="inline-link">Let me know!</a></p>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">What problem does this tool solve?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <ul class="faq-answer" style="margin-left: 20px; margin-top: 8px;">
                                    <li>Our tool helps ensure that you are alerted as early as possible whenever a coding agent might benefit from your input.</li>
                                    <li>Our tool frees you from having to actively monitor whether or not a coding agent requires your input.</li>
                                </ul>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">How do Apple "Focuses" (e.g. "Do Not Disturb," Work, Sleep) affect this app's audio notifications?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <p class="faq-answer">
                                    Via <a href="#" class="inline-link" onclick="event.preventDefault(); document.querySelector('[data-view=claude-code]').click(); requestAnimationFrame(() => document.getElementById('focus-settings').scrollIntoView({block: 'start'}));">this application's Claude Code page</a> you can control how Focuses affect this application's audio notifications. Please see the "Silence audio when a Focus is active" toggle.
                                </p>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">How do Apple "Focuses" (e.g. "Do Not Disturb," Work, Sleep) affect this app's visual notifications?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <p class="faq-answer">
                                    This application's visual notifications are delivered via <a href="https://github.com/julienXX/terminal-notifier" target="_blank" class="inline-link">terminal-notifier</a>, a utility for delivering native macOS notifications. 
                                    By default visual notifications are suppressed if a Focus mode is active. 
                                    <br>
                                    <br>
                                    Follow the instructions below if you would like for this application's visual notifications to deliver regardless of whether or not a Focus is active.
                                </p>
                                <ol class="faq-answer" style="margin-left: 20px; margin-top: 12px;">
                                    <li>Open <a href="#" class="inline-link" id="openFocusSettingsLink">Focus Settings.</a></li>
                                    <li>Select the Focus that you want to allow coding agent visual notifications for.</li>
                                    <li>From there select <strong>Allowed Apps</strong> from the <strong>Allow Notifications</strong> section.</li>
                                    <li>From there add <strong>terminal-notifier</strong> to the list of <strong>Allowed Apps</strong>.</li>
                                </ol>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">How do I uninstall this application?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <!-- Content when installed -->
                                <div id="faqInstalledContent">
                                    <p class="faq-answer">
                                        <strong>Remove all values related to this application from ~/.claude/scripts/ and ~/.claude/settings.json</strong>
                                    </p>
                                    <p class="faq-answer" style="margin-top: 12px;">
                                        Click the button below to remove all values related to this application from ~/.claude/scripts/ and ~/.claude/settings.json. Please note that active Claude Code sessions will need to be restarted if these values are removed. An error message will display if these values are removed and a hook event fires before a previously active Claude Code session has been restarted.
                                    </p>
                                    <button id="installToggleBtn" class="btn-secondary" style="margin-top: 12px;">Remove values</button>

                                    <div id="restartWarning" class="info-banner" style="margin-top: 16px; background: #fff3cd; border-color: #ffc107; display: none;">
                                        <p style="margin: 0;"><strong>Note:</strong> You'll need to start a new Claude Code session for the changes to take effect. Your current session will continue showing hook errors until you restart.</p>
                                        <p style="margin: 12px 0 0 0;">If a Claude Code event fires before you restart, you may see an error like: <code style="font-size: 12px;">Stop [bash /Users/.../.claude/scripts/smart-notify.sh stop] failed with non-blocking status code 127: No such file or directory</code>. This is expected and harmless—it simply means Claude Code is trying to call the notification script that was just removed.</p>
                                    </div>

                                    <p class="faq-answer" style="margin-top: 24px;">
                                        <strong>Uninstall our desktop app</strong><br>
                                        After removing all values related to this application from ~/.claude/scripts/ and ~/.claude/settings.json, you can delete this application by moving it the "Trash" folder. <a href="https://support.apple.com/en-us/102610" target="_blank" class="inline-link">Here</a> is Apple's documentation on "How to delete or uninstall an app."
                                    </p>
                                </div>

                                <!-- Content when uninstalled -->
                                <div id="faqUninstalledContent" style="display: none;">
                                    <p class="faq-answer">
                                        <strong>Remove all values related to this application from ~/.claude/scripts/ and ~/.claude/settings.json</strong>
                                    </p>
                                    <p class="faq-answer" style="margin-top: 12px;">
                                        If you are reading this copy, that means that values required for this application's notifications are missing from <code>~/.claude/scripts/</code> and <code>~/.claude/settings.json</code>.

                                        <br><br>If you would like for these values to be restored then please click the button below.
                                    </p>
                                    <button id="faqReinstallBtn" class="btn-secondary" style="margin-top: 24px;">Restore notifications values</button>

                                    <p class="faq-answer" style="margin-top: 24px;">
                                        <strong>Step 2: Uninstall the desktop app</strong><br>
                                        After the values that power this application's notifications have been removed from <code>~/.claude/scripts/</code> and <code>~/.claude/settings.json</code>, you can delete this desktop application by moving it to the Trash. <a href="https://support.apple.com/guide/mac-help/delete-files-and-folders-on-mac-mchlp1093/mac" target="_blank" class="inline-link">This Apple documentation</a> showcases how to do that.
                                    </p>
                                </div>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">Can someone help troubleshoot an issue that I am experiencing?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <p class="faq-answer">
                                    Definitely. Please click the "Export diagnostics" button below, and email the generated file to <a href="mailto:cwveysey@gmail.com?subject=Audio%20Notifier%20Diagnostics" style="color: #0066cc;">cwveysey@gmail.com</a>.
                                <br>
                                <button id="exportDiagnosticsBtn" class="btn-secondary" style="margin-top: 16px;">Export diagnostics</button>
                                <button id="exportLogBtn" class="btn-secondary" style="margin-top: 12px;">Export installation log</button>
                            </div>
                        </details>

                        <details class="collapsible-section faq-item" id="privacy-faq">
                            <summary class="collapsible-header">
                                <h3 class="faq-question">What data does this app collect?</h3>
                            </summary>
                            <div class="collapsible-content">
                                <p class="faq-answer">
                                    By default this app collects anonymous usage data. This is meant to help us understand how people use the app, so that we can improve it over time. Users have the option to switch off <a href="#" class="inline-link" onclick="event.preventDefault(); document.querySelector('[data-view=overview]').click(); requestAnimationFrame(() => document.getElementById('analyticsEnabled').scrollIntoView({block: 'center'}));">the "Help improve this app by sharing anonymous usage data" toggle</a>.
                                </p>

                                <p class="faq-answer" style="margin-top: 12px;">
                                    <strong>Data that we collect</strong>
                                </p>
                                <ul class="faq-answer" style="margin-left: 20px; margin-top: 8px;">
                                    <li>Event details (e.g. "app opened," "hook toggled," "sound changed," "settings saved").</li>
                                    <li>Device and platform details (macOS version, app version).</li>
                                    <li>Error messages and stack traces when crashes occur.</li>
                                </ul>

                                <p class="faq-answer" style="margin-top: 12px;">
                                    <strong>Data that we don't collect</strong>
                                </p>
                                <ul class="faq-answer" style="margin-left: 20px; margin-top: 8px;">
                                    <li>Name, email, IP address.</li>
                                    <li>Code, file paths, file contents.</li>
                                    <li>Session recordings, screenshots.</li>
                                    <li>Precise location data.</li>
                                </ul>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- Support View -->
                <div class="view" data-view="support" style="display: none;">
                    <div class="getting-started">
                        <h2>Support</h2>
                        <p class="getting-started-text">
                            If you have any questions, encounter any issues, or would like to request a feature or improvement, <a href="mailto:cwveysey@gmail.com" class="inline-link">please drop me a line via email</a>. Any and all feedback is of course so appreciated.
                        </p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script type="module" src="/main.js"></script>
</body>
</html>
